# Stable-Omarchy Hyprland Configuration
# Managed by chezmoi - adapted from Omarchy (DHH, Feb 2026) for Aurora-DX
# Learn how to configure Hyprland: https://wiki.hyprland.org/Configuring/

# ── Monitor ──────────────────────────────────────────────────────────
# Adapted from Omarchy monitors.conf - templated per machine
{{ if eq .monitor_scale "2" -}}
env = GDK_SCALE,2
monitor = {{ .monitor_primary }}, preferred, auto, 2
{{- else if eq .monitor_scale "1.5" -}}
env = GDK_SCALE,2
monitor = {{ .monitor_primary }}, {{ .monitor_res }}, 0x0, {{ .monitor_scale }}
{{- else -}}
env = GDK_SCALE,1
monitor = {{ .monitor_primary }}, preferred, auto, 1
{{- end }}
monitor = , preferred, auto, auto

# ── Environment (from Omarchy default/hypr/envs.conf) ───────────────
env = XCURSOR_SIZE,24
env = HYPRCURSOR_SIZE,24
env = GDK_BACKEND,wayland,x11,*
env = QT_QPA_PLATFORM,wayland;xcb
env = SDL_VIDEODRIVER,wayland,x11
env = MOZ_ENABLE_WAYLAND,1
env = ELECTRON_OZONE_PLATFORM_HINT,wayland
env = OZONE_PLATFORM,wayland
env = XDG_SESSION_TYPE,wayland
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_DESKTOP,Hyprland

{{ if eq .gpu "nvidia" -}}
# NVIDIA-specific (required for RTX 5080 Blackwell)
env = LIBVA_DRIVER_NAME,nvidia
env = __GLX_VENDOR_LIBRARY_NAME,nvidia
env = GBM_BACKEND,nvidia-drm
env = NVD_BACKEND,direct

cursor {
    no_hardware_cursors = true
}
{{- end }}

xwayland {
    force_zero_scaling = true
}

ecosystem {
    no_update_news = true
}

# ── Autostart ────────────────────────────────────────────────────────
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = systemctl --user start xdg-desktop-portal-hyprland
exec-once = waybar
exec-once = hyprpaper
exec-once = hypridle
exec-once = dunst
exec-once = /usr/libexec/polkit-gnome-authentication-agent-1
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store

# ── Input (from Omarchy input.conf) ─────────────────────────────────
input {
    kb_options = compose:caps

    repeat_rate = 40
    repeat_delay = 600
    numlock_by_default = true
    follow_mouse = 1

    touchpad {
        natural_scroll = true
        scroll_factor = 0.4
    }
}

# ── General ──────────────────────────────────────────────────────────
general {
    gaps_in = 5
    gaps_out = 10
    border_size = 2
    col.active_border = rgba(89b4faee) rgba(cba6f7ee) 45deg
    col.inactive_border = rgba(313244aa)
    layout = dwindle
}

# ── Decoration ───────────────────────────────────────────────────────
decoration {
    rounding = 10
    blur {
        enabled = true
        size = 6
        passes = 3
        new_optimizations = true
        xray = true
    }
    shadow {
        enabled = true
        range = 20
        render_power = 3
        color = rgba(1a1a2eee)
    }
}

# ── Animations ───────────────────────────────────────────────────────
animations {
    enabled = true
    bezier = overshot, 0.05, 0.9, 0.1, 1.1
    bezier = smoothOut, 0.36, 0, 0.66, -0.56
    bezier = smoothIn, 0.25, 1, 0.5, 1

    animation = windows, 1, 5, overshot, slide
    animation = windowsOut, 1, 4, smoothOut, slide
    animation = border, 1, 10, default
    animation = fade, 1, 5, smoothIn
    animation = workspaces, 1, 6, default
}

# ── Layout ───────────────────────────────────────────────────────────
dwindle {
    pseudotile = true
    preserve_split = true
    force_split = 2
}

# ── Misc ─────────────────────────────────────────────────────────────
misc {
    force_default_wallpaper = 0
    disable_hyprland_logo = true
    disable_splash_rendering = true
    vfr = true
}

# ── Tiling Keybindings (from Omarchy tiling-v2.conf) ────────────────
$mainMod = SUPER

# Close windows
bindd = $mainMod, W, Close window, killactive,

# Control tiling
bindd = $mainMod, J, Toggle window split, togglesplit,
bindd = $mainMod, P, Pseudo window, pseudo,
bindd = $mainMod, T, Toggle window floating/tiling, togglefloating,
bindd = $mainMod, F, Full screen, fullscreen, 0
bindd = $mainMod CTRL, F, Tiled full screen, fullscreenstate, 0 2
bindd = $mainMod ALT, F, Full width, fullscreen, 1

# Move focus
bindd = $mainMod, LEFT, Move window focus left, movefocus, l
bindd = $mainMod, RIGHT, Move window focus right, movefocus, r
bindd = $mainMod, UP, Move window focus up, movefocus, u
bindd = $mainMod, DOWN, Move window focus down, movefocus, d

# Switch workspaces
bindd = $mainMod, code:10, Switch to workspace 1, workspace, 1
bindd = $mainMod, code:11, Switch to workspace 2, workspace, 2
bindd = $mainMod, code:12, Switch to workspace 3, workspace, 3
bindd = $mainMod, code:13, Switch to workspace 4, workspace, 4
bindd = $mainMod, code:14, Switch to workspace 5, workspace, 5
bindd = $mainMod, code:15, Switch to workspace 6, workspace, 6
bindd = $mainMod, code:16, Switch to workspace 7, workspace, 7
bindd = $mainMod, code:17, Switch to workspace 8, workspace, 8
bindd = $mainMod, code:18, Switch to workspace 9, workspace, 9
bindd = $mainMod, code:19, Switch to workspace 10, workspace, 10

# Move active window to workspace
bindd = $mainMod SHIFT, code:10, Move window to workspace 1, movetoworkspace, 1
bindd = $mainMod SHIFT, code:11, Move window to workspace 2, movetoworkspace, 2
bindd = $mainMod SHIFT, code:12, Move window to workspace 3, movetoworkspace, 3
bindd = $mainMod SHIFT, code:13, Move window to workspace 4, movetoworkspace, 4
bindd = $mainMod SHIFT, code:14, Move window to workspace 5, movetoworkspace, 5
bindd = $mainMod SHIFT, code:15, Move window to workspace 6, movetoworkspace, 6
bindd = $mainMod SHIFT, code:16, Move window to workspace 7, movetoworkspace, 7
bindd = $mainMod SHIFT, code:17, Move window to workspace 8, movetoworkspace, 8
bindd = $mainMod SHIFT, code:18, Move window to workspace 9, movetoworkspace, 9
bindd = $mainMod SHIFT, code:19, Move window to workspace 10, movetoworkspace, 10

# Scratchpad
bindd = $mainMod, S, Toggle scratchpad, togglespecialworkspace, scratchpad
bindd = $mainMod ALT, S, Move window to scratchpad, movetoworkspacesilent, special:scratchpad

# TAB between workspaces
bindd = $mainMod, TAB, Next workspace, workspace, e+1
bindd = $mainMod SHIFT, TAB, Previous workspace, workspace, e-1
bindd = $mainMod CTRL, TAB, Former workspace, workspace, previous

# Move workspaces to other monitors
bindd = $mainMod SHIFT ALT, LEFT, Move workspace to left monitor, movecurrentworkspacetomonitor, l
bindd = $mainMod SHIFT ALT, RIGHT, Move workspace to right monitor, movecurrentworkspacetomonitor, r

# Swap windows
bindd = $mainMod SHIFT, LEFT, Swap window to the left, swapwindow, l
bindd = $mainMod SHIFT, RIGHT, Swap window to the right, swapwindow, r
bindd = $mainMod SHIFT, UP, Swap window up, swapwindow, u
bindd = $mainMod SHIFT, DOWN, Swap window down, swapwindow, d

# Cycle through windows on active workspace
bindd = ALT, TAB, Cycle to next window, cyclenext
bindd = ALT SHIFT, TAB, Cycle to prev window, cyclenext, prev
bindd = ALT, TAB, Reveal active window on top, bringactivetotop
bindd = ALT SHIFT, TAB, Reveal active window on top, bringactivetotop

# Resize
bindd = $mainMod, code:20, Expand window left, resizeactive, -100 0
bindd = $mainMod, code:21, Shrink window left, resizeactive, 100 0
bindd = $mainMod SHIFT, code:20, Shrink window up, resizeactive, 0 -100
bindd = $mainMod SHIFT, code:21, Expand window down, resizeactive, 0 100

# Mouse
bindd = $mainMod, mouse_down, Scroll active workspace forward, workspace, e+1
bindd = $mainMod, mouse_up, Scroll active workspace backward, workspace, e-1
bindmd = $mainMod, mouse:272, Move window, movewindow
bindmd = $mainMod, mouse:273, Resize window, resizewindow

# Groups
bindd = $mainMod, G, Toggle window grouping, togglegroup
bindd = $mainMod ALT, G, Move active window out of group, moveoutofgroup
bindd = $mainMod ALT, LEFT, Move window to group on left, moveintogroup, l
bindd = $mainMod ALT, RIGHT, Move window to group on right, moveintogroup, r
bindd = $mainMod ALT, TAB, Next window in group, changegroupactive, f
bindd = $mainMod ALT SHIFT, TAB, Previous window in group, changegroupactive, b

# ── Application Bindings (from Omarchy bindings.conf) ────────────────
bindd = $mainMod, RETURN, Terminal, exec, ghostty
bindd = $mainMod ALT, RETURN, Tmux, exec, ghostty tmux
bindd = $mainMod SHIFT, F, File manager, exec, nautilus --new-window
bindd = $mainMod SHIFT, B, Browser, exec, chromium
bindd = $mainMod SHIFT, N, Editor, exec, ghostty -e nvim
bindd = $mainMod SHIFT, D, Docker, exec, ghostty -e lazydocker

# Launcher
bindd = $mainMod, SPACE, App launcher, exec, wofi --show drun

# Screenshot
bind = , Print, exec, grim -g "$(slurp)" - | swappy -f -
bind = $mainMod, Print, exec, grim - | swappy -f -

# Clipboard history
bindd = $mainMod, V, Clipboard history, exec, cliphist list | wofi --show dmenu | cliphist decode | wl-copy

# ── Window Rules ─────────────────────────────────────────────────────
windowrulev2 = float, class:^(pavucontrol)$
windowrulev2 = float, class:^(nm-connection-editor)$
windowrulev2 = float, class:^(org.gnome.Calculator)$
windowrulev2 = float, title:^(Picture-in-Picture)$
windowrulev2 = float, class:^(xdg-desktop-portal-gtk)$

# Smooth terminal scrolling
windowrule = match:class com.mitchellh.ghostty, scroll_touchpad 0.2

# OBS
windowrulev2 = workspace 9 silent, class:^(com.obsproject.Studio)$
